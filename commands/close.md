# Закрытие спринта

Выполни последовательность закрытия спринта (фаза 4-6).
Не пропускай ни одного шага. Если gate не пройден — остановись и сообщи.

## Шаг 1: Показать итоги (GATE 3 — Приёмка)

Прочитай файл целей проекта и покажи владельцу:

```
Цель G-XXX достигнута

Критерий успеха:
[x] критерий 1
[x] критерий 2

Что сделано:
- список изменений

Проверка scope creep:
- Все изменения в рамках декомпозиции? (да/нет)

Файлы: [список созданных/изменённых]
```

Сценарии тестирования НЕ дублировать — они уже показаны после аудита.

**Жди явное "ОК" от владельца.** Без него дальше не двигайся.

## Шаг 2: Написание тестов (@tester)

После приёмки владельцем — запусти @tester для написания unit/integration тестов:

```
Используй Task tool с subagent_type=tester.
Передай контекст: какие файлы созданы/изменены, какие API endpoints, какие UI-компоненты.
```

Тесты должны покрывать:
- API endpoints/procedures (unit тесты с мок-контекстом)
- Утилиты/хелперы если есть
- Критичные edge cases из тест-кейсов

**После написания тестов** — перейди к pre-commit проверкам.

## Шаг 3: Pre-commit проверки (GATE 4)

### 3.0: Проверка миграций БД (если схема изменена)

Если в текущем спринте менялась схема БД:

1. Проверь что миграции синхронизированы (команду ищи в CLAUDE.md)
2. Если есть незафиксированные изменения — **СТОП**: создай миграцию
3. Проверь что файлы миграций созданы

### 3.1: Стандартные проверки

Запусти проверки качества (команды ищи в CLAUDE.md или package.json):

1. **Lint** — линтер
2. **Type-check** — проверка типов
3. **Build** — сборка
4. **Test** — тесты

Все проверки должны пройти. Если хотя бы одна упала — исправь и повтори.

## Шаг 4: Commit

- `git diff --stat` для понимания изменений
- Сформируй осмысленное сообщение коммита
- Исключи: .env, credentials, .claude/settings.local.json
- Добавь Co-Authored-By

## Шаг 5: Обновить tracking docs

- Отметь цель как достигнутую в файле целей
- Перемести в "Достигнутые цели"
- Отметь завершённые фичи в бэклоге

## Шаг 6: Чек-лист документации (GATE 5)

Покажи владельцу заполненный чек-лист. Адаптируй под проект:

```
Документация:
[ ] Component registry  — новые компоненты зарегистрированы?
[ ] API docs            — новые endpoints документированы?
[ ] Architecture docs   — архитектурные решения зафиксированы?
[ ] Backlog             — фичи/TD отмечены?
[ ] Test scenarios      — сценарии добавлены/актуализированы?
[ ] @documentor         — нужна проверка консистентности?
```

Пропусти пункты, которые не применимы к проекту.

## Шаг 7: Рефлексия

Ответь на 5 вопросов и покажи владельцу:

1. Что нового узнали в этом спринте?
2. Какие вопросы задавал пользователь, которых нет в инструкциях?
3. Что было сложно / неочевидно?
4. Какие шаги workflow были нарушены и почему?
5. Что нужно добавить/изменить в инструкциях?

При необходимости — обнови инструкции (CLAUDE.md, workflow docs, гайды).

## Шаг 8: Финальный коммит документации

Если шаги 5-7 изменили файлы — создай отдельный коммит для документации.
