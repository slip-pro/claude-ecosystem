# Планирование проекта (PRE-GATE)

Помоги владельцу сформулировать цели и наполнить бэклог.
Используй когда: новый проект без GOALS.md, или очередь целей пуста после завершения всех.

Каждый шаг обязателен. Без подтверждения владельца файлы не создавай и не меняй.

## Шаг 0: Определение режима

Прочитай CLAUDE.md проекта (если есть) и найди пути к файлам целей и бэклога.

**Проверь наличие файлов:**

1. **CLAUDE.md** — должен существовать.
   Если нет — СТОП:
   ```
   CLAUDE.md не найден.

   Для начала работы нужен CLAUDE.md с описанием проекта и стека.
   Создать минимальный CLAUDE.md сейчас? (название проекта, стек, пути к файлам)
   ```
   Если владелец подтвердил — помоги создать минимальный CLAUDE.md, затем продолжи.

2. **GOALS.md** и **BACKLOG.md** — определяют режим работы:

   | GOALS.md | Очередь целей | Режим |
   |----------|--------------|-------|
   | Нет | — | **A: Новый проект** |
   | Есть | Пустая (все достигнуты или нет записей) | **B: Пополнение очереди** |
   | Есть | Есть цели в очереди | СТОП — используй `/sprint` |

## Шаг 1: Обсуждение целей

### Режим A: Новый проект

Спроси у владельца:

```
Начинаем планирование нового проекта.

1. Какова главная цель проекта? (в 1-2 предложениях)
2. Кто целевой пользователь?
3. Какие ключевые результаты нужно достичь?
```

На основе ответов предложи 2-5 целей:

```
Предлагаю следующие цели:

G-001: [Название]
  Критерий успеха:
  - [ ] [измеримый результат 1]
  - [ ] [измеримый результат 2]
  Зависит от: —

G-002: [Название]
  Критерий успеха:
  - [ ] [измеримый результат]
  Зависит от: G-001

G-003: [Название]
  Критерий успеха:
  - [ ] [измеримый результат]
  Зависит от: —

Порядок очереди соответствует зависимостям.
Скорректировать? Добавить/убрать/изменить?
```

**Жди подтверждения владельца.** Итерируй пока не будет "ОК".

### Режим B: Пополнение очереди

Покажи владельцу текущее состояние:

```
Все цели достигнуты! Текущее состояние:

Достигнутые цели:
- G-001: [название] ✅
- G-002: [название] ✅

Tech Debt: N записей (H high / M medium / L low)
Фич в архиве: X

Какое направление дальше?
1. Развитие текущей функциональности
2. Новое направление / новая область
3. Погашение tech debt как приоритет
```

На основе ответа — предложи новые цели (формат как в Режиме A).
Нумерация G-XXX продолжается от последнего номера в файле.

**Жди подтверждения владельца.**

## Шаг 2: Наполнение бэклога

Для каждой согласованной цели предложи фичи:

```
Фичи для G-XXX: [название цели]

F-001: [Название фичи]
  Описание: [что и зачем]
  Критерии приёмки:
  - [ ] [критерий 1]
  - [ ] [критерий 2]

F-002: [Название фичи]
  Описание: [что и зачем]
  Критерии приёмки:
  - [ ] [критерий 1]

Скорректировать? Добавить/убрать/изменить критерии?
```

Нумерация F-XXX:
- Режим A — начинай с F-001
- Режим B — продолжай от последнего номера в BACKLOG.md

**Жди подтверждения владельца по каждой цели.** Не переходи к следующей цели без "ОК".

## Шаг 3: Создание / обновление файлов

Покажи владельцу план записи:

```
Готов записать:

Создать / Обновить:
- GOALS.md — [N новых целей в очереди]
- BACKLOG.md — [M фич для N целей]

Создать (только для нового проекта):
- DECISIONS.md — workflow и gates (из шаблона)
- docs/notes/ — директория для заметок спринтов

Путь для workflow-файлов: [путь из CLAUDE.md или предложить стандартный]

Записать?
```

**Жди "ОК" от владельца.**

### Режим A: Новый проект

1. Создай GOALS.md из шаблона `workflow/GOALS-TEMPLATE.md`:
   - Заполни секцию "ОЧЕРЕДЬ ЦЕЛЕЙ" согласованными целями
   - Обнови метрики (Всего: N, В очереди: N)

2. Создай BACKLOG.md из шаблона `workflow/BACKLOG-TEMPLATE.md`:
   - Заполни секции фичами, сгруппированными по целям

3. Скопируй DECISIONS-TEMPLATE.md → DECISIONS.md
   - Замени `[Project Name]` на имя проекта

4. Создай директорию для заметок (если нет)

### Режим B: Пополнение очереди

1. Обнови GOALS.md:
   - Добавь новые цели в секцию "ОЧЕРЕДЬ ЦЕЛЕЙ"
   - Обнови метрики

2. Обнови BACKLOG.md:
   - Добавь новые секции фич для новых целей

## Шаг 4: Итоги

Покажи финальную сводку:

```
Планирование завершено!

Целей в очереди: N
Фич в бэклоге: M
Файлы: [список созданных/обновлённых]

Следующий шаг:
- /pbr — если нужно детализировать фичи
- /sprint — чтобы начать работу над первой целью
```
