---
name: task
description: Открыть работу над задачей с доски. Выбор задачи, планирование с владельцем, настройка, старт разработки.
argument-hint: "[card-id]"
allowed-tools: mcp__board__get_board_tasks, mcp__board__get_card_details, mcp__board__move_card, mcp__board__add_comment, mcp__board__update_card
---

# Открытие работы над задачей

Выполни последовательность открытия работы — фаза 1 (Планирование, GATE 1) из DECISIONS.md.
Каждый шаг обязателен. Без подтверждения владельца дальше не двигайся.

## Шаг 0: Проверка предусловий

Вызови `get_board_tasks` и проверь:

1. **Нет ли задач в In Progress** — если есть, СТОП. Покажи:
   ```
   В работе: [название задачи]

   Варианты:
   A) Закрыть текущую задачу сначала (/done)
   B) Продолжить работу над текущей задачей
   C) Взять новую задачу параллельно (требует подтверждения)
   ```
   Жди решения владельца. Без явного выбора дальше не двигайся.

2. **Есть задачи в очереди** — колонки со статусом задач, готовых к взятию, не пусты.
   Если пусты — сообщи и предложи создать новую задачу.

## Шаг 1: Выбор задачи

**Если передан аргумент** (`$ARGUMENTS`) — это ID карточки, используй его. Перейди к шагу 2.

**Если аргумент не передан:**

Покажи задачи из колонок с готовыми к взятию задачами (названия колонок зависят от доски проекта):

```
Задачи, готовые к взятию:
1. [название] — [приоритет, исполнители]
2. ...

Какую задачу берём в работу?
```

**Жди явный выбор владельца.**

## Шаг 2: Получение деталей

Вызови `get_card_details` с ID выбранной карточки.
Покажи владельцу описание, чеклисты, комментарии — весь контекст задачи.

## Шаг 3: Совместное планирование (GATE 1)

1. Обсуди с владельцем **критерии готовности** — что значит "сделано"
2. Обсуди **подход** — как реализовать
3. **Согласуй декомпозицию** — разбей на подзадачи вместе с владельцем

**ВАЖНО**: Декомпозиция требует согласия владельца! Не разбивай самостоятельно.

Покажи итоговый план:

```
Задача: [название]

Критерии готовности:
- [ ] [критерий 1]
- [ ] [критерий 2]

Декомпозиция:
- [ ] [подзадача 1] — [описание]
- [ ] [подзадача 2] — [описание]
- [ ] [подзадача 3] — [описание]

Подход: [краткое описание]
```

**Жди явное "ОК" или корректировки от владельца.**
Без подтверждения декомпозиции дальше не двигайся — это GATE 1.

## Шаг 4: Настройка

После получения "ОК" от владельца:

1. **Переместить карточку** — `move_card` в колонку "In Progress" (или аналог на доске проекта)
2. **Добавить комментарий** — `add_comment`: "Взято в работу"
3. **Обновить описание** — `update_card`: добавить к описанию раздел с планом реализации (**формат HTML**, пример: `<h2>План реализации</h2><ol><li>...</li></ol>`)

## Шаг 5: Старт

Покажи владельцу:

```
Начинаю работу над: [название задачи]

Критерии готовности:
- [критерий 1]
- [критерий 2]

План работы:
1. [подзадача 1]
2. [подзадача 2]
...

Есть вопросы перед стартом? Если нет, начинаю.
```

**Жди "ОК" от владельца.** После подтверждения — переходи к фазе 2 (Разработка по DECISIONS.md).
